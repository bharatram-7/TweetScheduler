{% extends 'twitter/main_base.html' %}
{% load static %}
{% block title %}History{% endblock title %}
{% block body %}
<div class="integrations">
    <div class="active-accounts">
        <button class="social-accounts" disabled>
            {% if name == "No integrations set" %}
                {{ name }}
            {% else %}
                <i class="gg-twitter"></i>
                {{ name }}
            {% endif %}
        </button>
    </div>
    <div class="integrations-bottom">
        <a href="{% url 'integrations' %}">
            <button class="social-accounts">
                {% if name == "No integrations set" %}
                    Add an Integration
                {% else %}
                    Re-authorize
                {% endif %}
            </button>
        </a>
    </div>
</div>
<div class="main-area">
    <nav class="nav-bar">
        <a class="nav-item" href="{% url 'dashboard' %}">Queue</a>
        <a class="nav-item active" href="#">History</a>
    </nav>
    <div class="post-wrapper" id="history_app">
    <table>
        <tr>
            <th>No</th>
            <th>Content</th>
            <th>Posted time</th>
        </tr>
        <tr v-for="entry in historyData">
            <td></td>
            <td>[[ entry.content ]]</td>
            <td>[[ entry.posted_time ]]</td>
        </tr>
    </table>
    </div>
</div>
<script>
    var history_app = new Vue({
        delimiters: ["[[", "]]"],
        el: "#history_app",
        data: {
            historyData: []
        },
        mounted: function(){
            axios.get("{% url 'history_list_view' %}"
            ).then((response) => {
                console.log(response.data)
                this.historyData = response.data
            }).catch((err) => {
                if (err.status){
                    alert("Oops! Something went wrong while fetching your post history");
                }
                console.log(err);
            });
        }
    });
</script>
{% endblock body %}
